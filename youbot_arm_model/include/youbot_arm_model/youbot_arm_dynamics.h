/*
 * YoubotArmDynamics.hpp
 *
 *  Created on: May 27, 2013
 *      Author: keiserb
 */

#ifndef YOUBOTARMDYNAMICS_HPP_
#define YOUBOTARMDYNAMICS_HPP_

#include <math.h>
#include <kdl/jntarray.hpp>
#include <Eigen/Dense>

using namespace Eigen;

void getM(MatrixXd & M, KDL::JntArray& pos)
{
  //double c_1 = cos(pos(0));
  double c_2 = cos(pos(1));
  double c_3 = cos(pos(2));
  double c_4 = cos(pos(3));
  double c_5 = cos(pos(4));
  //double s_1 = sin(pos(0));
  double s_2 = sin(pos(1));
  double s_3 = sin(pos(2));
  double s_4 = sin(pos(3));
  double s_5 = sin(pos(4));
  double term_1 = (2259.0*sin(pos(1) - pos(2) + pos(3) + pos(4)))/62500000.0;
  double term_2 = (753.0*cos(pos(1) - pos(2) + pos(3) - pos(4)))/1000000000.0;
  double term_3 = (3969783.0*c_4);
  double term_4 = (2259.0*pow(c_5,2))/1000000000.0;
  double term_5 = (753.0*c_5);
  double term_6 = (27027.0*s_4);
  double term_7 = (20331.0*c_5*s_4);
  double term_8 = (4557899.0*s_3*s_4);
  double term_9 = (4557899.0*c_3*c_4);
  double term_10 = (31031.0*c_3*s_4);
  double term_11 = (753.0*cos(pos(1) - pos(2) + pos(3) + pos(4)));
  double term_12 = (31031.0*c_4*s_3);
  double term_13 = (2259.0*cos(pos(1) - pos(2) + pos(3) - 2*pos(4)));
  double term_14 = (2259.0*cos(pos(1) - pos(2) + pos(3) + 2*pos(4)));
  double term_15 = (2259.0*sin(pos(1) - pos(2) + pos(3) - pos(4)));
  double term_16 = (20331.0*sin(pos(1) - pos(2) + pos(4)));
  double term_17 = (25433.0*cos(pos(1) - pos(2) + pos(3)));
  double term_18 = (23343.0*c_3*c_5*s_4);
  double term_19 = (23343.0*c_4*c_5*s_3);
  M(0,0) = (4557899.0*cos(pos(2) - pos(3)))/200000000.0- (753.0*cos(2*pos(1) - 2*pos(2) + 2*pos(3) - pos(4)))/1000000000.0+ (2259.0*cos(2*pos(1) - 2*pos(2) + 2*pos(3) - 2*pos(4)))/8000000000.0+ (2259.0*cos(2*pos(1) - 2*pos(2) + 2*pos(3) + 2*pos(4)))/8000000000.0- (2700357.0*sin(pos(1) - pos(2)))/125000000.0+ (31031.0*sin(pos(2) - pos(3)))/100000000.0+ (20331.0*sin(pos(3) - pos(4)))/400000000.0- (2259.0*sin(2*pos(1) - 2*pos(2) + 2*pos(3) - pos(4)))/62500000.0- (1864633.0*cos(2*pos(1)))/50000000.0- (2259.0*cos(2*pos(4)))/4000000000.0- (31441279.0*cos(2*pos(1) - 2*pos(2) + 2*pos(3)))/4000000000.0+ (30399.0*sin(2*pos(1) - 2*pos(2) + 2*pos(3)))/125000000.0+ (24849.0*cos(pos(1) - pos(2) + pos(3) - pos(4)))/1000000000.0- (23343.0*sin(2*pos(1) - pos(2) + pos(3) + pos(4)))/400000000.0- (20331.0*sin(2*pos(1) - 2*pos(2) + pos(3) + pos(4)))/400000000.0- (2536699.0*cos(2*pos(1) - pos(2)))/50000000.0- (10013911.0*cos(2*pos(1) - 2*pos(2)))/500000000.0- (33033.0*cos(pos(1) - pos(2) + pos(3)))/250000000.0- (4851957.0*sin(pos(1) - pos(2) + pos(3)))/500000000.0- (23343.0*sin(pos(2) - pos(3) + pos(4)))/400000000.0- (753.0*cos(2*pos(1) - 2*pos(2) + 2*pos(3) + pos(4)))/1000000000.0+ (20331.0*sin(pos(3) + pos(4)))/400000000.0- (23343.0*sin(2*pos(1) - pos(2) + pos(3) - pos(4)))/400000000.0- (20331.0*sin(2*pos(1) - 2*pos(2) + pos(3) - pos(4)))/400000000.0- (2259.0*sin(2*pos(1) - 2*pos(2) + 2*pos(3) + pos(4)))/62500000.0+ (2536699.0*c_3)/50000000.0+ term_3/200000000.0- term_5/500000000.0- (4557899.0*cos(2*pos(1) - pos(2) + pos(3)))/200000000.0- (3969783.0*cos(2*pos(1) - 2*pos(2) + pos(3)))/200000000.0- (347127.0*s_2)/10000000.0- term_6/100000000.0+ (31031.0*sin(2*pos(1) - pos(2) + pos(3)))/100000000.0+ (27027.0*sin(2*pos(1) - 2*pos(2) + pos(3)))/100000000.0- (23343.0*sin(pos(2) - pos(3) - pos(4)))/400000000.0+ (24849.0*cos(pos(1) - pos(2) + pos(3) + pos(4)))/1000000000.0+ 105207843/800000000.0;
  M(0,1) = term_1 + (441029.0*cos(pos(1) - pos(2)))/500000000.0- (23343.0*sin(pos(1) - pos(4)))/400000000.0- term_2 + term_13/4000000000.0- term_14/4000000000.0- term_15/62500000.0- term_17/100000000.0+ term_16/400000000.0+ (23343.0*sin(pos(1) + pos(4)))/400000000.0- (18867.0*c_2)/100000000.0- (20331.0*sin(pos(1) - pos(2) - pos(4)))/400000000.0+ term_11/1000000000.0;
  M(0,2) = term_2 - (441029.0*cos(pos(1) - pos(2)))/500000000.0- term_1 - term_13/4000000000.0+ term_14/4000000000.0+ term_15/62500000.0+ term_17/100000000.0- term_16/400000000.0+ (20331.0*sin(pos(1) - pos(2) - pos(4)))/400000000.0- term_11/1000000000.0;
  M(0,3) = term_1 - term_2 + term_13/4000000000.0- term_14/4000000000.0- term_15/62500000.0- term_17/100000000.0+ term_11/1000000000.0;
  M(0,4) = (20002259.0*cos(pos(1) - pos(2) + pos(3)))/1000000000.0- (23343.0*sin(pos(1) - pos(4)))/400000000.0- term_2 - term_15/62500000.0- term_1 - term_16/400000000.0- (23343.0*sin(pos(1) + pos(4)))/400000000.0+ (24849.0*c_5)/1000000000.0- (20331.0*sin(pos(1) - pos(2) - pos(4)))/400000000.0- term_11/1000000000.0;
  M(1,0) = M(0,1);
  M(1,1) = (2536699.0*c_3)/25000000.0+ term_3/100000000.0 - term_5/250000000.0 - term_6/50000000.0+ term_9/100000000.0- term_10/50000000.0+ term_12/50000000.0+ term_7/100000000.0+ term_8/100000000.0+ term_4 + term_18/100000000.0- term_19/100000000.0+ 180370741/1000000000.0;
  M(1,2) = term_5/250000000.0 - term_3/100000000.0 - (2536699.0*c_3)/50000000.0+ term_6/50000000.0- term_9/200000000.0+ term_10/100000000.0- term_12/100000000.0- term_7/100000000.0- term_8/200000000.0- term_4 - term_18/200000000.0+ term_19/200000000.0- 95785421/1000000000.0;
  M(1,3) = term_3/200000000.0- term_5/250000000.0 - term_6/100000000.0+ term_9/200000000.0- term_10/100000000.0+ term_12/100000000.0+ term_7/200000000.0+ term_8/200000000.0+ term_4 + term_18/200000000.0- term_19/200000000.0+ 45729777/1000000000.0;
  M(1,4) = (753.0*s_5*(155.0*cos(pos(2) - pos(3)) + 135.0*c_4 + 96))/1000000000.0;
  M(2,0) = M(0,2);
  M(2,1) = M(1,2);
  M(2,2) = term_3/100000000.0 - term_5/250000000.0 - term_6/50000000.0+ term_7/100000000.0+ term_4 + 95785421/1000000000.0;
  M(2,3) = term_5/250000000.0 - term_3/200000000.0+ term_6/100000000.0- term_7/200000000.0- term_4 - 45729777/1000000000.0;
  M(2,4) = -(2259.0*s_5*(45.0*c_4 + 32))/1000000000.0;
  M(3,0) = M(0,3);
  M(3,1) = M(1,3);
  M(3,2) = M(2,3);
  M(3,3) = term_4 - term_5/250000000.0 + 45729777.0/1000000000.0;
  M(3,4) = (2259.0*s_5)/31250000.0;
  M(4,0) = M(0,4);
  M(4,1) = M(1,4);
  M(4,2) = M(2,4);
  M(4,3) = M(3,4);
  M(4,4) = 20002259.0/1000000000.0;
}

void getC(MatrixXd & C, KDL::JntArray& pos, KDL::JntArray& vel)
{
  //double c_1 = cos(pos(0));
  double c_2 = cos(pos(1));
  double c_3 = cos(pos(2));
  double c_4 = cos(pos(3));
  double c_5 = cos(pos(4));
  //double s_1 = sin(pos(0));
  double s_2 = sin(pos(1));
  double s_3 = sin(pos(2));
  double s_4 = sin(pos(3));
  double s_5 = sin(pos(4));
  double s_23 = sin(pos(1) - pos(2));
  double s_34 = sin(pos(2) - pos(3));
  double s2_2 = sin(2*pos(1));
  double s2_5 = sin(2*pos(4));
  double c_23 = cos(pos(1) - pos(2));
  double c_34 = cos(pos(2) - pos(3));
  double c_45 = cos(pos(3) + pos(4));
  double c_4_5 = cos(pos(3) - pos(4));
  double c_25 = cos(pos(1) + pos(4));
  double c_2_5 = cos(pos(1) - pos(4));
  double s2_23 = sin(2*pos(1) - 2*pos(2));
  double c_345 = cos(pos(2) - pos(3) + pos(4));
  double c_34_5 = cos(pos(2) - pos(3) - pos(4));
  double c_235 = cos(pos(1) - pos(2) + pos(4));
  double c_23_5 = cos(pos(1) - pos(2) - pos(4));
  double c_234 = cos(pos(1) - pos(2) + pos(3));
  double s_234 = sin(pos(1) - pos(2) + pos(3));
  double s_223 = sin(2*pos(1) - pos(2));
  double s2_234 = sin(2*pos(1) - 2*pos(2) + 2*pos(3));
  double s_2234 = sin(2*pos(1) - pos(2) + pos(3));
  double c_2234 = cos(2*pos(1) - pos(2) + pos(3));
  double c2_234 = cos(2*pos(1) - 2*pos(2) + 2*pos(3));
  double c_22345 = cos(2*pos(1) - pos(2) + pos(3) + pos(4));
  double c_2234_5 = cos(2*pos(1) - pos(2) + pos(3) - pos(4));
  double c_2345 = cos(pos(1) - pos(2) + pos(3) + pos(4));
  double s_2345 = sin(pos(1) - pos(2) + pos(3) + pos(4));
  double s_234_5 = sin(pos(1) - pos(2) + pos(3) - pos(4));
  double c_234_5 = cos(pos(1) - pos(2) + pos(3) - pos(4));
  double s_234_25 = sin(pos(1) - pos(2) + pos(3) - 2*pos(4));
  double s_23425 = sin(pos(1) - pos(2) + pos(3) + 2*pos(4));
  double s_22234 = sin(2*pos(1) - 2*pos(2) + pos(3));
  double c_22234 = cos(2*pos(1) - 2*pos(2) + pos(3));
  double c_22234_5 = cos(2*pos(1) - 2*pos(2) + pos(3) - pos(4));
  double c_222345 = cos(2*pos(1) - 2*pos(2) + pos(3) + pos(4));
  double s_2223245 = sin(2*pos(1) - 2*pos(2) + 2*pos(3) + pos(4));
  double s_222324_5 = sin(2*pos(1) - 2*pos(2) + 2*pos(3) - pos(4));
  double c_222324_5 = cos(2*pos(1) - 2*pos(2) + 2*pos(3) - pos(4));
  double c_2223245 = cos(2*pos(1) - 2*pos(2) + 2*pos(3) + pos(4));
  double s2_2345 = sin(2*pos(1) - 2*pos(2) + 2*pos(3) + 2*pos(4));
  double s2_234_5 = sin(2*pos(1) - 2*pos(2) + 2*pos(3) - 2*pos(4));

  C(0,0) = (30399.0*vel(1)*c2_234)/125000000.0 - (30399.0*vel(2)*c2_234)/125000000.0 + (30399.0*vel(3)*c2_234)/125000000.0 + (1864633.0*vel(1)*s2_2)/50000000.0 + (2259.0*vel(4)*s2_5)/4000000000.0 + (31441279.0*vel(1)*s2_234)/4000000000.0 - (31441279.0*vel(2)*s2_234)/4000000000.0 + (31441279.0*vel(3)*s2_234)/4000000000.0 - (23343.0*vel(1)*c_22345)/400000000.0 - (20331.0*vel(1)*c_222345)/400000000.0 + (23343.0*vel(2)*c_22345)/800000000.0 + (20331.0*vel(2)*c_222345)/400000000.0 - (23343.0*vel(3)*c_22345)/800000000.0 - (20331.0*vel(3)*c_222345)/800000000.0 - (23343.0*vel(4)*c_22345)/800000000.0 - (20331.0*vel(4)*c_222345)/800000000.0 - (24849.0*vel(1)*s_234_5)/2000000000.0 + (24849.0*vel(2)*s_234_5)/2000000000.0 - (24849.0*vel(3)*s_234_5)/2000000000.0 + (24849.0*vel(4)*s_234_5)/2000000000.0 + (2536699.0*vel(1)*s_223)/50000000.0 + (10013911.0*vel(1)*s2_23)/500000000.0 - (2536699.0*vel(2)*s_223)/100000000.0 - (10013911.0*vel(2)*s2_23)/500000000.0 - (4851957.0*vel(1)*c_234)/1000000000.0 + (4851957.0*vel(2)*c_234)/1000000000.0 - (4851957.0*vel(3)*c_234)/1000000000.0 - (23343.0*vel(2)*c_345)/800000000.0 + (23343.0*vel(3)*c_345)/800000000.0 - (23343.0*vel(4)*c_345)/800000000.0 + (33033.0*vel(1)*s_234)/500000000.0 - (33033.0*vel(2)*s_234)/500000000.0 + (33033.0*vel(3)*s_234)/500000000.0 + (20331.0*vel(3)*c_45)/800000000.0 + (20331.0*vel(4)*c_45)/800000000.0 - (23343.0*vel(1)*c_2234_5)/400000000.0 - (20331.0*vel(1)*c_22234_5)/400000000.0 + (23343.0*vel(2)*c_2234_5)/800000000.0 - (2259.0*vel(1)*c_2223245)/62500000.0 + (20331.0*vel(2)*c_22234_5)/400000000.0 - (23343.0*vel(3)*c_2234_5)/800000000.0 + (2259.0*vel(2)*c_2223245)/62500000.0 - (20331.0*vel(3)*c_22234_5)/800000000.0 + (23343.0*vel(4)*c_2234_5)/800000000.0 - (2259.0*vel(3)*c_2223245)/62500000.0 + (20331.0*vel(4)*c_22234_5)/800000000.0 - (2259.0*vel(4)*c_2223245)/125000000.0 + (753.0*vel(1)*s_2223245)/1000000000.0 - (753.0*vel(2)*s_2223245)/1000000000.0 + (753.0*vel(3)*s_2223245)/1000000000.0 + (753.0*vel(4)*s_2223245)/2000000000.0 - (347127.0*vel(1)*c_2)/20000000.0 - (27027.0*vel(3)*c_4)/200000000.0 + (31031.0*vel(1)*c_2234)/100000000.0 + (27027.0*vel(1)*c_22234)/100000000.0 - (31031.0*vel(2)*c_2234)/200000000.0 - (27027.0*vel(2)*c_22234)/100000000.0 + (31031.0*vel(3)*c_2234)/200000000.0 - (23343.0*vel(2)*c_34_5)/800000000.0 + (27027.0*vel(3)*c_22234)/200000000.0 + (23343.0*vel(3)*c_34_5)/800000000.0 + (23343.0*vel(4)*c_34_5)/800000000.0 - (2536699.0*vel(2)*s_3)/100000000.0 - (3969783.0*vel(3)*s_4)/400000000.0 + (753.0*vel(4)*s_5)/1000000000.0 + (4557899.0*vel(1)*s_2234)/200000000.0 + (3969783.0*vel(1)*s_22234)/200000000.0 - (4557899.0*vel(2)*s_2234)/400000000.0 - (3969783.0*vel(2)*s_22234)/200000000.0 + (4557899.0*vel(3)*s_2234)/400000000.0 + (3969783.0*vel(3)*s_22234)/400000000.0 - (24849.0*vel(1)*s_2345)/2000000000.0 + (24849.0*vel(2)*s_2345)/2000000000.0 - (24849.0*vel(3)*s_2345)/2000000000.0 - (24849.0*vel(4)*s_2345)/2000000000.0 - (2700357.0*vel(1)*c_23)/250000000.0 + (2700357.0*vel(2)*c_23)/250000000.0 + (31031.0*vel(2)*c_34)/200000000.0 - (31031.0*vel(3)*c_34)/200000000.0 + (20331.0*vel(3)*c_4_5)/800000000.0 - (20331.0*vel(4)*c_4_5)/800000000.0 - (2259.0*vel(1)*c_222324_5)/62500000.0 + (2259.0*vel(2)*c_222324_5)/62500000.0 - (2259.0*vel(3)*c_222324_5)/62500000.0 + (2259.0*vel(4)*c_222324_5)/125000000.0 - (4557899.0*vel(2)*s_34)/400000000.0 + (4557899.0*vel(3)*s_34)/400000000.0 + (753.0*vel(1)*s_222324_5)/1000000000.0 - (2259.0*vel(1)*s2_234_5)/8000000000.0 - (2259.0*vel(1)*s2_2345)/8000000000.0 - (753.0*vel(2)*s_222324_5)/1000000000.0 + (2259.0*vel(2)*s2_234_5)/8000000000.0 + (2259.0*vel(2)*s2_2345)/8000000000.0 + (753.0*vel(3)*s_222324_5)/1000000000.0 - (2259.0*vel(3)*s2_234_5)/8000000000.0 - (2259.0*vel(3)*s2_2345)/8000000000.0 - (753.0*vel(4)*s_222324_5)/2000000000.0 + (2259.0*vel(4)*s2_234_5)/8000000000.0 - (2259.0*vel(4)*s2_2345)/8000000000.0;
  C(0,1) = (30399.0*vel(0)*c2_234)/125000000.0 + (1864633.0*vel(0)*s2_2)/50000000.0 + (31441279.0*vel(0)*s2_234)/4000000000.0 - (23343.0*vel(0)*c_22345)/400000000.0 - (2259.0*vel(1)*c_234_5)/62500000.0 - (20331.0*vel(0)*c_222345)/400000000.0 + (2259.0*vel(2)*c_234_5)/62500000.0 - (2259.0*vel(3)*c_234_5)/62500000.0 - (24849.0*vel(0)*s_234_5)/2000000000.0 + (753.0*vel(1)*s_234_5)/1000000000.0 - (2259.0*vel(1)*s_234_25)/4000000000.0 + (2259.0*vel(1)*s_23425)/4000000000.0 - (753.0*vel(2)*s_234_5)/1000000000.0 + (2259.0*vel(2)*s_234_25)/4000000000.0 - (2259.0*vel(2)*s_23425)/4000000000.0 + (753.0*vel(3)*s_234_5)/1000000000.0 - (2259.0*vel(3)*s_234_25)/4000000000.0 + (2259.0*vel(3)*s_23425)/4000000000.0 + (2259.0*vel(4)*s_234_25)/4000000000.0 + (2259.0*vel(4)*s_23425)/4000000000.0 + (2536699.0*vel(0)*s_223)/50000000.0 + (10013911.0*vel(0)*s2_23)/500000000.0 - (4851957.0*vel(0)*c_234)/1000000000.0 + (20331.0*vel(1)*c_235)/400000000.0 - (20331.0*vel(2)*c_235)/400000000.0 + (33033.0*vel(0)*s_234)/500000000.0 + (25433.0*vel(1)*s_234)/100000000.0 - (25433.0*vel(2)*s_234)/100000000.0 + (25433.0*vel(3)*s_234)/100000000.0 - (20002259.0*vel(4)*s_234)/2000000000.0 + (23343.0*vel(1)*c_25)/400000000.0 - (23343.0*vel(0)*c_2234_5)/400000000.0 - (20331.0*vel(0)*c_22234_5)/400000000.0 - (2259.0*vel(0)*c_2223245)/62500000.0 + (753.0*vel(0)*s_2223245)/1000000000.0 - (347127.0*vel(0)*c_2)/20000000.0 + (31031.0*vel(0)*c_2234)/100000000.0 + (27027.0*vel(0)*c_22234)/100000000.0 - (20331.0*vel(1)*c_23_5)/400000000.0 + (20331.0*vel(2)*c_23_5)/400000000.0 + (18867.0*vel(1)*s_2)/100000000.0 + (4557899.0*vel(0)*s_2234)/200000000.0 + (3969783.0*vel(0)*s_22234)/200000000.0 + (2259.0*vel(1)*c_2345)/62500000.0 - (2259.0*vel(2)*c_2345)/62500000.0 + (2259.0*vel(3)*c_2345)/62500000.0 - (24849.0*vel(0)*s_2345)/2000000000.0 - (753.0*vel(1)*s_2345)/1000000000.0 + (753.0*vel(2)*s_2345)/1000000000.0 - (753.0*vel(3)*s_2345)/1000000000.0 - (2700357.0*vel(0)*c_23)/250000000.0 - (23343.0*vel(1)*c_2_5)/400000000.0 - (2259.0*vel(0)*c_222324_5)/62500000.0 - (441029.0*vel(1)*s_23)/500000000.0 + (441029.0*vel(2)*s_23)/500000000.0 + (753.0*vel(0)*s_222324_5)/1000000000.0 - (2259.0*vel(0)*s2_234_5)/8000000000.0 - (2259.0*vel(0)*s2_2345)/8000000000.0;
  C(0,2) = (23343.0*vel(0)*c_22345)/800000000.0 - (31441279.0*vel(0)*s2_234)/4000000000.0 - (30399.0*vel(0)*c2_234)/125000000.0 + (2259.0*vel(1)*c_234_5)/62500000.0 + (20331.0*vel(0)*c_222345)/400000000.0 - (2259.0*vel(2)*c_234_5)/62500000.0 + (2259.0*vel(3)*c_234_5)/62500000.0 + (24849.0*vel(0)*s_234_5)/2000000000.0 - (753.0*vel(1)*s_234_5)/1000000000.0 + (2259.0*vel(1)*s_234_25)/4000000000.0 - (2259.0*vel(1)*s_23425)/4000000000.0 + (753.0*vel(2)*s_234_5)/1000000000.0 - (2259.0*vel(2)*s_234_25)/4000000000.0 + (2259.0*vel(2)*s_23425)/4000000000.0 - (753.0*vel(3)*s_234_5)/1000000000.0 + (2259.0*vel(3)*s_234_25)/4000000000.0 - (2259.0*vel(3)*s_23425)/4000000000.0 - (2259.0*vel(4)*s_234_25)/4000000000.0 - (2259.0*vel(4)*s_23425)/4000000000.0 - (2536699.0*vel(0)*s_223)/100000000.0 - (10013911.0*vel(0)*s2_23)/500000000.0 + (4851957.0*vel(0)*c_234)/1000000000.0 - (20331.0*vel(1)*c_235)/400000000.0 - (23343.0*vel(0)*c_345)/800000000.0 + (20331.0*vel(2)*c_235)/400000000.0 - (33033.0*vel(0)*s_234)/500000000.0 - (25433.0*vel(1)*s_234)/100000000.0 + (25433.0*vel(2)*s_234)/100000000.0 - (25433.0*vel(3)*s_234)/100000000.0 + (20002259.0*vel(4)*s_234)/2000000000.0 + (23343.0*vel(0)*c_2234_5)/800000000.0 + (20331.0*vel(0)*c_22234_5)/400000000.0 + (2259.0*vel(0)*c_2223245)/62500000.0 - (753.0*vel(0)*s_2223245)/1000000000.0 - (31031.0*vel(0)*c_2234)/200000000.0 - (27027.0*vel(0)*c_22234)/100000000.0 + (20331.0*vel(1)*c_23_5)/400000000.0 - (23343.0*vel(0)*c_34_5)/800000000.0 - (20331.0*vel(2)*c_23_5)/400000000.0 - (2536699.0*vel(0)*s_3)/100000000.0 - (4557899.0*vel(0)*s_2234)/400000000.0 - (3969783.0*vel(0)*s_22234)/200000000.0 - (2259.0*vel(1)*c_2345)/62500000.0 + (2259.0*vel(2)*c_2345)/62500000.0 - (2259.0*vel(3)*c_2345)/62500000.0 + (24849.0*vel(0)*s_2345)/2000000000.0 + (753.0*vel(1)*s_2345)/1000000000.0 - (753.0*vel(2)*s_2345)/1000000000.0 + (753.0*vel(3)*s_2345)/1000000000.0 + (2700357.0*vel(0)*c_23)/250000000.0 + (31031.0*vel(0)*c_34)/200000000.0 + (2259.0*vel(0)*c_222324_5)/62500000.0 + (441029.0*vel(1)*s_23)/500000000.0 - (4557899.0*vel(0)*s_34)/400000000.0 - (441029.0*vel(2)*s_23)/500000000.0 - (753.0*vel(0)*s_222324_5)/1000000000.0 + (2259.0*vel(0)*s2_234_5)/8000000000.0 + (2259.0*vel(0)*s2_2345)/8000000000.0;
  C(0,3) = (30399.0*vel(0)*c2_234)/125000000.0 + (31441279.0*vel(0)*s2_234)/4000000000.0 - (23343.0*vel(0)*c_22345)/800000000.0 - (2259.0*vel(1)*c_234_5)/62500000.0 - (20331.0*vel(0)*c_222345)/800000000.0 + (2259.0*vel(2)*c_234_5)/62500000.0 - (2259.0*vel(3)*c_234_5)/62500000.0 - (24849.0*vel(0)*s_234_5)/2000000000.0 + (753.0*vel(1)*s_234_5)/1000000000.0 - (2259.0*vel(1)*s_234_25)/4000000000.0 + (2259.0*vel(1)*s_23425)/4000000000.0 - (753.0*vel(2)*s_234_5)/1000000000.0 + (2259.0*vel(2)*s_234_25)/4000000000.0 - (2259.0*vel(2)*s_23425)/4000000000.0 + (753.0*vel(3)*s_234_5)/1000000000.0 - (2259.0*vel(3)*s_234_25)/4000000000.0 + (2259.0*vel(3)*s_23425)/4000000000.0 + (2259.0*vel(4)*s_234_25)/4000000000.0 + (2259.0*vel(4)*s_23425)/4000000000.0 - (4851957.0*vel(0)*c_234)/1000000000.0 + (23343.0*vel(0)*c_345)/800000000.0 + (33033.0*vel(0)*s_234)/500000000.0 + (25433.0*vel(1)*s_234)/100000000.0 - (25433.0*vel(2)*s_234)/100000000.0 + (25433.0*vel(3)*s_234)/100000000.0 - (20002259.0*vel(4)*s_234)/2000000000.0 + (20331.0*vel(0)*c_45)/800000000.0 - (23343.0*vel(0)*c_2234_5)/800000000.0 - (20331.0*vel(0)*c_22234_5)/800000000.0 - (2259.0*vel(0)*c_2223245)/62500000.0 + (753.0*vel(0)*s_2223245)/1000000000.0 - (27027.0*vel(0)*c_4)/200000000.0 + (31031.0*vel(0)*c_2234)/200000000.0 + (27027.0*vel(0)*c_22234)/200000000.0 + (23343.0*vel(0)*c_34_5)/800000000.0 - (3969783.0*vel(0)*s_4)/400000000.0 + (4557899.0*vel(0)*s_2234)/400000000.0 + (3969783.0*vel(0)*s_22234)/400000000.0 + (2259.0*vel(1)*c_2345)/62500000.0 - (2259.0*vel(2)*c_2345)/62500000.0 + (2259.0*vel(3)*c_2345)/62500000.0 - (24849.0*vel(0)*s_2345)/2000000000.0 - (753.0*vel(1)*s_2345)/1000000000.0 + (753.0*vel(2)*s_2345)/1000000000.0 - (753.0*vel(3)*s_2345)/1000000000.0 - (31031.0*vel(0)*c_34)/200000000.0 + (20331.0*vel(0)*c_4_5)/800000000.0 - (2259.0*vel(0)*c_222324_5)/62500000.0 + (4557899.0*vel(0)*s_34)/400000000.0 + (753.0*vel(0)*s_222324_5)/1000000000.0 - (2259.0*vel(0)*s2_234_5)/8000000000.0 - (2259.0*vel(0)*s2_2345)/8000000000.0;
  C(0,4) = (2259.0*vel(0)*s2_5)/4000000000.0 - (23343.0*vel(0)*c_22345)/800000000.0 - (20331.0*vel(0)*c_222345)/800000000.0 + (2259.0*vel(4)*c_234_5)/62500000.0 + (24849.0*vel(0)*s_234_5)/2000000000.0 + (2259.0*vel(1)*s_234_25)/4000000000.0 + (2259.0*vel(1)*s_23425)/4000000000.0 - (2259.0*vel(2)*s_234_25)/4000000000.0 - (2259.0*vel(2)*s_23425)/4000000000.0 + (2259.0*vel(3)*s_234_25)/4000000000.0 + (2259.0*vel(3)*s_23425)/4000000000.0 - (753.0*vel(4)*s_234_5)/1000000000.0 - (23343.0*vel(0)*c_345)/800000000.0 - (20331.0*vel(4)*c_235)/400000000.0 - (20002259.0*vel(1)*s_234)/2000000000.0 + (20002259.0*vel(2)*s_234)/2000000000.0 - (20002259.0*vel(3)*s_234)/2000000000.0 + (20331.0*vel(0)*c_45)/800000000.0 - (23343.0*vel(4)*c_25)/400000000.0 + (23343.0*vel(0)*c_2234_5)/800000000.0 + (20331.0*vel(0)*c_22234_5)/800000000.0 - (2259.0*vel(0)*c_2223245)/125000000.0 + (753.0*vel(0)*s_2223245)/2000000000.0 + (23343.0*vel(0)*c_34_5)/800000000.0 + (20331.0*vel(4)*c_23_5)/400000000.0 + (753.0*vel(0)*s_5)/1000000000.0 - (24849.0*vel(4)*s_5)/1000000000.0 - (2259.0*vel(4)*c_2345)/62500000.0 - (24849.0*vel(0)*s_2345)/2000000000.0 + (753.0*vel(4)*s_2345)/1000000000.0 - (20331.0*vel(0)*c_4_5)/800000000.0 + (23343.0*vel(4)*c_2_5)/400000000.0 + (2259.0*vel(0)*c_222324_5)/125000000.0 - (753.0*vel(0)*s_222324_5)/2000000000.0 + (2259.0*vel(0)*s2_234_5)/8000000000.0 - (2259.0*vel(0)*s2_2345)/8000000000.0;
  C(1,0) = (vel(0)*((24849.0*s_2345)/1000000000.0 + (2700357.0*c_23)/125000000.0 + (2259.0*c_222324_5)/31250000.0 - (753.0*s_222324_5)/500000000.0 + (2259.0*s2_234_5)/4000000000.0 + (2259.0*s2_2345)/4000000000.0 - (30399.0*c2_234)/62500000.0 - (1864633.0*s2_2)/25000000.0 - (31441279.0*s2_234)/2000000000.0 + (23343.0*c_22345)/200000000.0 + (20331.0*c_222345)/200000000.0 + (24849.0*s_234_5)/1000000000.0 - (2536699.0*s_223)/25000000.0 - (10013911.0*s2_23)/250000000.0 + (4851957.0*c_234)/500000000.0 - (33033.0*s_234)/250000000.0 + (23343.0*c_2234_5)/200000000.0 + (20331.0*c_22234_5)/200000000.0 + (2259.0*c_2223245)/31250000.0 - (753.0*s_2223245)/500000000.0 + (347127.0*c_2)/10000000.0 - (31031.0*c_2234)/50000000.0 - (27027.0*c_22234)/50000000.0 - (4557899.0*s_2234)/100000000.0 - (3969783.0*s_22234)/100000000))/2 + (vel(4)*((23343.0*c_2_5)/200000000.0 - (753.0*s_2345)/500000000.0 + (2259.0*c_234_5)/31250000.0 - (753.0*s_234_5)/500000000.0 + (2259.0*s_234_25)/2000000000.0 + (2259.0*s_23425)/2000000000.0 + (20331.0*c_235)/200000000.0 + (20002259.0*s_234)/1000000000.0 + (23343.0*c_25)/200000000.0 + (20331.0*c_23_5)/200000000.0 + (2259.0*c_2345)/31250000))/2;
  C(1,1) = (vel(3)*((20331.0*c_4_5)/200000000.0 - (31031.0*c_34)/50000000.0 + (4557899.0*s_34)/100000000.0 + (23343.0*c_345)/200000000.0 + (20331.0*c_45)/200000000.0 - (27027.0*c_4)/50000000.0 + (23343.0*c_34_5)/200000000.0 - (3969783.0*s_4)/100000000))/2 - (vel(2)*((4557899.0*s_34)/100000000.0 - (31031.0*c_34)/50000000.0 + (23343.0*c_345)/200000000.0 + (23343.0*c_34_5)/200000000.0 + (2536699.0*s_3)/25000000))/2 - (vel(4)*((2259.0*s2_5)/1000000000.0 - (753.0*s_5)/250000000.0 + (20331.0*s_4*s_5)/100000000.0 + (23343.0*c_3*s_4*s_5)/100000000.0 - (23343.0*c_4*s_3*s_5)/100000000))/2;
  C(1,2) = (2259.0*vel(4)*s2_5)/2000000000.0 - (23343.0*vel(1)*c_345)/400000000.0 + (23343.0*vel(2)*c_345)/400000000.0 - (23343.0*vel(3)*c_345)/400000000.0 + (23343.0*vel(4)*c_345)/400000000.0 - (20331.0*vel(3)*c_45)/400000000.0 - (20331.0*vel(4)*c_45)/400000000.0 + (27027.0*vel(3)*c_4)/100000000.0 - (23343.0*vel(1)*c_34_5)/400000000.0 + (23343.0*vel(2)*c_34_5)/400000000.0 - (23343.0*vel(3)*c_34_5)/400000000.0 - (23343.0*vel(4)*c_34_5)/400000000.0 - (2536699.0*vel(1)*s_3)/50000000.0 + (2536699.0*vel(2)*s_3)/50000000.0 + (3969783.0*vel(3)*s_4)/200000000.0 - (753.0*vel(4)*s_5)/500000000.0 + (31031.0*vel(1)*c_34)/100000000.0 - (31031.0*vel(2)*c_34)/100000000.0 + (31031.0*vel(3)*c_34)/100000000.0 - (20331.0*vel(3)*c_4_5)/400000000.0 + (20331.0*vel(4)*c_4_5)/400000000.0 - (4557899.0*vel(1)*s_34)/200000000.0 + (4557899.0*vel(2)*s_34)/200000000.0 - (4557899.0*vel(3)*s_34)/200000000.0;
  C(1,3) = (23343.0*vel(1)*c_345)/400000000.0 - (2259.0*vel(4)*s2_5)/2000000000.0 - (23343.0*vel(2)*c_345)/400000000.0 + (23343.0*vel(3)*c_345)/400000000.0 - (23343.0*vel(4)*c_345)/400000000.0 + (20331.0*vel(1)*c_45)/400000000.0 - (20331.0*vel(2)*c_45)/400000000.0 + (20331.0*vel(3)*c_45)/400000000.0 + (20331.0*vel(4)*c_45)/400000000.0 - (27027.0*vel(1)*c_4)/100000000.0 + (27027.0*vel(2)*c_4)/100000000.0 - (27027.0*vel(3)*c_4)/100000000.0 + (23343.0*vel(1)*c_34_5)/400000000.0 - (23343.0*vel(2)*c_34_5)/400000000.0 + (23343.0*vel(3)*c_34_5)/400000000.0 + (23343.0*vel(4)*c_34_5)/400000000.0 - (3969783.0*vel(1)*s_4)/200000000.0 + (3969783.0*vel(2)*s_4)/200000000.0 - (3969783.0*vel(3)*s_4)/200000000.0 + (753.0*vel(4)*s_5)/500000000.0 - (31031.0*vel(1)*c_34)/100000000.0 + (31031.0*vel(2)*c_34)/100000000.0 + (20331.0*vel(1)*c_4_5)/400000000.0 - (31031.0*vel(3)*c_34)/100000000.0 - (20331.0*vel(2)*c_4_5)/400000000.0 + (20331.0*vel(3)*c_4_5)/400000000.0 - (20331.0*vel(4)*c_4_5)/400000000.0 + (4557899.0*vel(1)*s_34)/200000000.0 - (4557899.0*vel(2)*s_34)/200000000.0 + (4557899.0*vel(3)*s_34)/200000000.0;
  C(1,4) = (2259.0*vel(2)*s2_5)/2000000000.0 - (2259.0*vel(1)*s2_5)/2000000000.0 - (2259.0*vel(3)*s2_5)/2000000000.0 + (2259.0*vel(0)*c_234_5)/62500000.0 - (753.0*vel(0)*s_234_5)/1000000000.0 + (2259.0*vel(0)*s_234_25)/4000000000.0 + (2259.0*vel(0)*s_23425)/4000000000.0 + (20331.0*vel(0)*c_235)/400000000.0 - (23343.0*vel(1)*c_345)/400000000.0 + (23343.0*vel(2)*c_345)/400000000.0 - (23343.0*vel(3)*c_345)/400000000.0 + (23343.0*vel(4)*c_345)/400000000.0 + (20002259.0*vel(0)*s_234)/2000000000.0 + (23343.0*vel(0)*c_25)/400000000.0 + (20331.0*vel(1)*c_45)/400000000.0 - (20331.0*vel(2)*c_45)/400000000.0 + (20331.0*vel(3)*c_45)/400000000.0 + (20331.0*vel(4)*c_45)/400000000.0 + (2259.0*vel(4)*c_5)/31250000.0 + (20331.0*vel(0)*c_23_5)/400000000.0 + (23343.0*vel(1)*c_34_5)/400000000.0 - (23343.0*vel(2)*c_34_5)/400000000.0 + (23343.0*vel(3)*c_34_5)/400000000.0 + (23343.0*vel(4)*c_34_5)/400000000.0 + (753.0*vel(1)*s_5)/500000000.0 - (753.0*vel(2)*s_5)/500000000.0 + (753.0*vel(3)*s_5)/500000000.0 + (2259.0*vel(0)*c_2345)/62500000.0 - (753.0*vel(0)*s_2345)/1000000000.0 + (23343.0*vel(0)*c_2_5)/400000000.0 - (20331.0*vel(1)*c_4_5)/400000000.0 + (20331.0*vel(2)*c_4_5)/400000000.0 - (20331.0*vel(3)*c_4_5)/400000000.0 + (20331.0*vel(4)*c_4_5)/400000000.0;
  C(2,0) = (vel(0)*((4557899.0*s_34)/200000000.0 - (2700357.0*c_23)/125000000.0 - (31031.0*c_34)/100000000.0 - (2259.0*c_222324_5)/31250000.0 - (24849.0*s_2345)/1000000000.0 + (753.0*s_222324_5)/500000000.0 - (2259.0*s2_234_5)/4000000000.0 - (2259.0*s2_2345)/4000000000.0 + (30399.0*c2_234)/62500000.0 + (31441279.0*s2_234)/2000000000.0 - (23343.0*c_22345)/400000000.0 - (20331.0*c_222345)/200000000.0 - (24849.0*s_234_5)/1000000000.0 + (2536699.0*s_223)/50000000.0 + (10013911.0*s2_23)/250000000.0 - (4851957.0*c_234)/500000000.0 + (23343.0*c_345)/400000000.0 + (33033.0*s_234)/250000000.0 - (23343.0*c_2234_5)/400000000.0 - (20331.0*c_22234_5)/200000000.0 - (2259.0*c_2223245)/31250000.0 + (753.0*s_2223245)/500000000.0 + (31031.0*c_2234)/100000000.0 + (27027.0*c_22234)/50000000.0 + (23343.0*c_34_5)/400000000.0 + (2536699.0*s_3)/50000000.0 + (4557899.0*s_2234)/200000000.0 + (3969783.0*s_22234)/100000000))/2 - (vel(4)*((2259.0*c_234_5)/31250000.0 - (753.0*s_2345)/500000000.0 - (753.0*s_234_5)/500000000.0 + (2259.0*s_234_25)/2000000000.0 + (2259.0*s_23425)/2000000000.0 + (20331.0*c_235)/200000000.0 + (20002259.0*s_234)/1000000000.0 + (20331.0*c_23_5)/200000000.0 + (2259.0*c_2345)/31250000))/2;
  C(2,1) = (2259.0*vel(4)*s2_5)/2000000000.0 + (27027.0*vel(3)*c_4)/100000000.0 + (2536699.0*vel(1)*s_3)/50000000.0 + (3969783.0*vel(3)*s_4)/200000000.0 - (753.0*vel(4)*s_5)/500000000.0 - (31031.0*vel(1)*c_3*c_4)/100000000.0 - (20331.0*vel(3)*c_4*c_5)/200000000.0 - (4557899.0*vel(1)*c_3*s_4)/200000000.0 + (4557899.0*vel(1)*c_4*s_3)/200000000.0 - (31031.0*vel(1)*s_3*s_4)/100000000.0 + (20331.0*vel(4)*s_4*s_5)/200000000.0 + (23343.0*vel(1)*c_3*c_4*c_5)/200000000.0 + (23343.0*vel(1)*c_5*s_3*s_4)/200000000.0;
  C(2,2) = -(vel(3)*((27027.0*c_4)/50000000.0 + (3969783.0*s_4)/100000000.0 - (20331.0*c_4*c_5)/100000000))/2 - (vel(4)*((2259.0*c_5*s_5)/500000000.0 - (753.0*s_5)/250000000.0 + (20331.0*s_4*s_5)/100000000))/2;
  C(2,3) = (vel(1)*((27027.0*c_4)/50000000.0 + (3969783.0*s_4)/100000000.0 - (20331.0*c_4*c_5)/100000000))/2 - (vel(2)*((27027.0*c_4)/50000000.0 + (3969783.0*s_4)/100000000.0 - (20331.0*c_4*c_5)/100000000))/2 + (vel(3)*((27027.0*c_4)/50000000.0 + (3969783.0*s_4)/100000000.0 - (20331.0*c_4*c_5)/100000000))/2 + (vel(4)*((2259.0*c_5*s_5)/500000000.0 - (753.0*s_5)/250000000.0 + (20331.0*s_4*s_5)/100000000))/2;
  C(2,4) = (2259.0*vel(1)*s2_5)/2000000000.0 - (2259.0*vel(2)*s2_5)/2000000000.0 + (2259.0*vel(3)*s2_5)/2000000000.0 - (2259.0*vel(0)*c_234_5)/62500000.0 + (753.0*vel(0)*s_234_5)/1000000000.0 - (2259.0*vel(0)*s_234_25)/4000000000.0 - (2259.0*vel(0)*s_23425)/4000000000.0 - (20331.0*vel(0)*c_235)/400000000.0 - (20002259.0*vel(0)*s_234)/2000000000.0 - (20331.0*vel(1)*c_45)/400000000.0 + (20331.0*vel(2)*c_45)/400000000.0 - (20331.0*vel(3)*c_45)/400000000.0 - (20331.0*vel(4)*c_45)/400000000.0 - (2259.0*vel(4)*c_5)/31250000.0 - (20331.0*vel(0)*c_23_5)/400000000.0 - (753.0*vel(1)*s_5)/500000000.0 + (753.0*vel(2)*s_5)/500000000.0 - (753.0*vel(3)*s_5)/500000000.0 - (2259.0*vel(0)*c_2345)/62500000.0 + (753.0*vel(0)*s_2345)/1000000000.0 + (20331.0*vel(1)*c_4_5)/400000000.0 - (20331.0*vel(2)*c_4_5)/400000000.0 + (20331.0*vel(3)*c_4_5)/400000000.0 - (20331.0*vel(4)*c_4_5)/400000000.0;
  C(3,0) = (vel(4)*((2259.0*c_234_5)/31250000.0 - (753.0*s_2345)/500000000.0 - (753.0*s_234_5)/500000000.0 + (2259.0*s_234_25)/2000000000.0 + (2259.0*s_23425)/2000000000.0 + (20002259.0*s_234)/1000000000.0 + (2259.0*c_2345)/31250000))/2 + (vel(0)*((24849.0*s_2345)/1000000000.0 + (31031.0*c_34)/100000000.0 - (20331.0*c_4_5)/400000000.0 + (2259.0*c_222324_5)/31250000.0 - (4557899.0*s_34)/200000000.0 - (753.0*s_222324_5)/500000000.0 + (2259.0*s2_234_5)/4000000000.0 + (2259.0*s2_2345)/4000000000.0 - (30399.0*c2_234)/62500000.0 - (31441279.0*s2_234)/2000000000.0 + (23343.0*c_22345)/400000000.0 + (20331.0*c_222345)/400000000.0 + (24849.0*s_234_5)/1000000000.0 + (4851957.0*c_234)/500000000.0 - (23343.0*c_345)/400000000.0 - (33033.0*s_234)/250000000.0 - (20331.0*c_45)/400000000.0 + (23343.0*c_2234_5)/400000000.0 + (20331.0*c_22234_5)/400000000.0 + (2259.0*c_2223245)/31250000.0 - (753.0*s_2223245)/500000000.0 + (27027.0*c_4)/100000000.0 - (31031.0*c_2234)/100000000.0 - (27027.0*c_22234)/100000000.0 - (23343.0*c_34_5)/400000000.0 + (3969783.0*s_4)/200000000.0 - (4557899.0*s_2234)/200000000.0 - (3969783.0*s_22234)/200000000))/2;
  C(3,1) = (27027.0*vel(1)*c_4)/100000000.0 - (2259.0*vel(4)*s2_5)/2000000000.0 - (27027.0*vel(2)*c_4)/100000000.0 + (3969783.0*vel(1)*s_4)/200000000.0 - (3969783.0*vel(2)*s_4)/200000000.0 + (753.0*vel(4)*s_5)/500000000.0 + (31031.0*vel(1)*c_3*c_4)/100000000.0 - (20331.0*vel(1)*c_4*c_5)/200000000.0 + (20331.0*vel(2)*c_4*c_5)/200000000.0 + (4557899.0*vel(1)*c_3*s_4)/200000000.0 - (4557899.0*vel(1)*c_4*s_3)/200000000.0 + (31031.0*vel(1)*s_3*s_4)/100000000.0 - (23343.0*vel(1)*c_3*c_4*c_5)/200000000.0 - (23343.0*vel(1)*c_5*s_3*s_4)/200000000.0;
  C(3,2) = (vel(2)*((27027.0*c_4)/50000000.0 + (3969783.0*s_4)/100000000.0 - (20331.0*c_4*c_5)/100000000))/2 - (vel(1)*((27027.0*c_4)/50000000.0 + (3969783.0*s_4)/100000000.0 - (20331.0*c_4*c_5)/100000000))/2 - (vel(4)*((753.0*s_5)/250000000.0 - (2259.0*c_5*s_5)/500000000))/2;
  C(3,3) = -(753.0*vel(4)*(3.0*s2_5 - 4.0*s_5))/2000000000.0;
  C(3,4) = (2259.0*vel(2)*s2_5)/2000000000.0 - (2259.0*vel(1)*s2_5)/2000000000.0 - (2259.0*vel(3)*s2_5)/2000000000.0 + (2259.0*vel(0)*c_234_5)/62500000.0 - (753.0*vel(0)*s_234_5)/1000000000.0 + (2259.0*vel(0)*s_234_25)/4000000000.0 + (2259.0*vel(0)*s_23425)/4000000000.0 + (20002259.0*vel(0)*s_234)/2000000000.0 + (2259.0*vel(4)*c_5)/31250000.0 + (753.0*vel(1)*s_5)/500000000.0 - (753.0*vel(2)*s_5)/500000000.0 + (753.0*vel(3)*s_5)/500000000.0 + (2259.0*vel(0)*c_2345)/62500000.0 - (753.0*vel(0)*s_2345)/1000000000.0;
  C(4,0) = (23343.0*vel(0)*c_22345)/800000000.0 - (2259.0*vel(0)*s2_5)/4000000000.0 - (2259.0*vel(1)*c_234_5)/62500000.0 + (20331.0*vel(0)*c_222345)/800000000.0 + (2259.0*vel(2)*c_234_5)/62500000.0 - (2259.0*vel(3)*c_234_5)/62500000.0 - (24849.0*vel(0)*s_234_5)/2000000000.0 + (753.0*vel(1)*s_234_5)/1000000000.0 - (2259.0*vel(1)*s_234_25)/4000000000.0 - (2259.0*vel(1)*s_23425)/4000000000.0 - (753.0*vel(2)*s_234_5)/1000000000.0 + (2259.0*vel(2)*s_234_25)/4000000000.0 + (2259.0*vel(2)*s_23425)/4000000000.0 + (753.0*vel(3)*s_234_5)/1000000000.0 - (2259.0*vel(3)*s_234_25)/4000000000.0 - (2259.0*vel(3)*s_23425)/4000000000.0 - (20331.0*vel(1)*c_235)/400000000.0 + (23343.0*vel(0)*c_345)/800000000.0 + (20331.0*vel(2)*c_235)/400000000.0 - (20002259.0*vel(1)*s_234)/2000000000.0 + (20002259.0*vel(2)*s_234)/2000000000.0 - (20002259.0*vel(3)*s_234)/2000000000.0 - (23343.0*vel(1)*c_25)/400000000.0 - (20331.0*vel(0)*c_45)/800000000.0 - (23343.0*vel(0)*c_2234_5)/800000000.0 - (20331.0*vel(0)*c_22234_5)/800000000.0 + (2259.0*vel(0)*c_2223245)/125000000.0 - (753.0*vel(0)*s_2223245)/2000000000.0 - (20331.0*vel(1)*c_23_5)/400000000.0 - (23343.0*vel(0)*c_34_5)/800000000.0 + (20331.0*vel(2)*c_23_5)/400000000.0 - (753.0*vel(0)*s_5)/1000000000.0 - (2259.0*vel(1)*c_2345)/62500000.0 + (2259.0*vel(2)*c_2345)/62500000.0 - (2259.0*vel(3)*c_2345)/62500000.0 + (24849.0*vel(0)*s_2345)/2000000000.0 + (753.0*vel(1)*s_2345)/1000000000.0 - (753.0*vel(2)*s_2345)/1000000000.0 + (753.0*vel(3)*s_2345)/1000000000.0 - (23343.0*vel(1)*c_2_5)/400000000.0 + (20331.0*vel(0)*c_4_5)/800000000.0 - (2259.0*vel(0)*c_222324_5)/125000000.0 + (753.0*vel(0)*s_222324_5)/2000000000.0 - (2259.0*vel(0)*s2_234_5)/8000000000.0 + (2259.0*vel(0)*s2_2345)/8000000000.0;
  C(4,1) = (2259.0*vel(1)*s2_5)/2000000000.0 - (2259.0*vel(2)*s2_5)/2000000000.0 + (2259.0*vel(3)*s2_5)/2000000000.0 - (2259.0*vel(0)*c_234_5)/62500000.0 + (753.0*vel(0)*s_234_5)/1000000000.0 - (2259.0*vel(0)*s_234_25)/4000000000.0 - (2259.0*vel(0)*s_23425)/4000000000.0 - (20331.0*vel(0)*c_235)/400000000.0 + (23343.0*vel(1)*c_345)/400000000.0 - (20002259.0*vel(0)*s_234)/2000000000.0 - (23343.0*vel(0)*c_25)/400000000.0 - (20331.0*vel(1)*c_45)/400000000.0 + (20331.0*vel(2)*c_45)/400000000.0 - (20331.0*vel(0)*c_23_5)/400000000.0 - (23343.0*vel(1)*c_34_5)/400000000.0 - (753.0*vel(1)*s_5)/500000000.0 + (753.0*vel(2)*s_5)/500000000.0 - (753.0*vel(3)*s_5)/500000000.0 - (2259.0*vel(0)*c_2345)/62500000.0 + (753.0*vel(0)*s_2345)/1000000000.0 - (23343.0*vel(0)*c_2_5)/400000000.0 + (20331.0*vel(1)*c_4_5)/400000000.0 - (20331.0*vel(2)*c_4_5)/400000000.0;
  C(4,2) = (2259.0*vel(2)*s2_5)/2000000000.0 - (2259.0*vel(1)*s2_5)/2000000000.0 - (2259.0*vel(3)*s2_5)/2000000000.0 + (2259.0*vel(0)*c_234_5)/62500000.0 - (753.0*vel(0)*s_234_5)/1000000000.0 + (2259.0*vel(0)*s_234_25)/4000000000.0 + (2259.0*vel(0)*s_23425)/4000000000.0 + (20331.0*vel(0)*c_235)/400000000.0 + (20002259.0*vel(0)*s_234)/2000000000.0 + (20331.0*vel(1)*c_45)/400000000.0 - (20331.0*vel(2)*c_45)/400000000.0 + (20331.0*vel(0)*c_23_5)/400000000.0 + (753.0*vel(1)*s_5)/500000000.0 - (753.0*vel(2)*s_5)/500000000.0 + (753.0*vel(3)*s_5)/500000000.0 + (2259.0*vel(0)*c_2345)/62500000.0 - (753.0*vel(0)*s_2345)/1000000000.0 - (20331.0*vel(1)*c_4_5)/400000000.0 + (20331.0*vel(2)*c_4_5)/400000000.0;
  C(4,3) = (2259.0*vel(1)*s2_5)/2000000000.0 - (2259.0*vel(2)*s2_5)/2000000000.0 + (2259.0*vel(3)*s2_5)/2000000000.0 - (2259.0*vel(0)*c_234_5)/62500000.0 + (753.0*vel(0)*s_234_5)/1000000000.0 - (2259.0*vel(0)*s_234_25)/4000000000.0 - (2259.0*vel(0)*s_23425)/4000000000.0 - (20002259.0*vel(0)*s_234)/2000000000.0 - (753.0*vel(1)*s_5)/500000000.0 + (753.0*vel(2)*s_5)/500000000.0 - (753.0*vel(3)*s_5)/500000000.0 - (2259.0*vel(0)*c_2345)/62500000.0 + (753.0*vel(0)*s_2345)/1000000000.0;
  C(4,4) = 0.0;
}


void getN(VectorXd & N, KDL::JntArray& pos)
{
  //double c_1 = cos(pos(0));
  double c_2 = cos(pos(1));
  double c_3 = cos(pos(2));
  double c_4 = cos(pos(3));
  double c_5 = cos(pos(4));
  //double s_1 = sin(pos(0));
  double s_2 = sin(pos(1));
  double s_3 = sin(pos(2));
  double s_4 = sin(pos(3));
  double s_5 = sin(pos(4));

  N(0) = 0.0;
  N(1) = (25767062667123676997.0*s_2)/11258999068426240000.0 - (88517464797832128003.0*c_2)/56294995342131200000.0 - (552806158210613379.0*(c_4*(c_2*c_3 + s_2*s_3) + s_4*(c_2*s_3 - c_3*s_2))*((11.0*c_5)/200.0 - 11.0/200.0))/56294995342131200.0 + (294008933574591813.0*c_2*c_3)/562949953421312000.0 - (1552937978909335579.0*c_2*((57.0*c_3)/1000.0 + (27.0*s_3)/100.0 - 57/1000.0))/56294995342131200.0 + (1800159961711097241.0*c_2*s_3)/562949953421312000.0 - (1800159961711097241.0*c_3*s_2)/562949953421312000.0 - (1552937978909335579.0*s_2*((57.0*s_3)/1000.0 - (27.0*c_3)/100.0 + 27/100.0))/56294995342131200.0 + (294008933574591813.0*s_2*s_3)/562949953421312000.0 + (3082018589152638507.0*c_5*(c_4*(c_2*c_3 + s_2*s_3) + s_4*(c_2*s_3 - c_3*s_2)))/5629499534213120000.0 + (276066204223679841.0*c_4*(c_2*c_3 + s_2*s_3))/562949953421312000.0 + (100247227274517223483.0*c_4*(c_2*s_3 - c_3*s_2))/11258999068426240000.0 - (1037132832287244679.0*(c_2*s_3 - c_3*s_2)*((81.0*c_4)/200.0 + (57.0*s_4)/1000.0 - 81.0/200.0))/56294995342131200.0 + (1037132832287244679.0*(c_2*c_3 + s_2*s_3)*((81.0*s_4)/200.0 - (57.0*c_4)/1000.0 + 57/1000.0))/56294995342131200.0 - (100247227274517223483.0*s_4*(c_2*c_3 + s_2*s_3))/11258999068426240000.0 + (276066204223679841.0*s_4*(c_2*s_3 - c_3*s_2))/562949953421312000.0;
  N(2) = (552806158210613379.0*(c_4*(c_2*c_3 + s_2*s_3) + s_4*(c_2*s_3 - c_3*s_2))*((11.0*c_5)/200.0 - 11.0/200.0))/56294995342131200.0 - (294008933574591813.0*c_2*c_3)/562949953421312000.0 + (1552937978909335579.0*c_2*((57.0*c_3)/1000.0 + (27.0*s_3)/100.0))/56294995342131200.0 - (1800159961711097241.0*c_2*s_3)/562949953421312000.0 + (1800159961711097241.0*c_3*s_2)/562949953421312000.0 - (1552937978909335579.0*s_2*((27.0*c_3)/100.0 - (57.0*s_3)/1000.0))/56294995342131200.0 - (294008933574591813.0*s_2*s_3)/562949953421312000.0 - (3082018589152638507.0*c_5*(c_4*(c_2*c_3 + s_2*s_3) + s_4*(c_2*s_3 - c_3*s_2)))/5629499534213120000.0 - (276066204223679841.0*c_4*(c_2*c_3 + s_2*s_3))/562949953421312000.0 - (100247227274517223483.0*c_4*(c_2*s_3 - c_3*s_2))/11258999068426240000.0 + (1037132832287244679.0*(c_2*s_3 - c_3*s_2)*((81.0*c_4)/200.0 + (57.0*s_4)/1000.0 - 81.0/200.0))/56294995342131200.0 - (1037132832287244679.0*(c_2*c_3 + s_2*s_3)*((81.0*s_4)/200.0 - (57.0*c_4)/1000.0 + 57/1000.0))/56294995342131200.0 + (100247227274517223483.0*s_4*(c_2*c_3 + s_2*s_3))/11258999068426240000.0 - (276066204223679841.0*s_4*(c_2*s_3 - c_3*s_2))/562949953421312000.0;
  N(3) = (3082018589152638507.0*c_5*(c_4*(c_2*c_3 + s_2*s_3) + s_4*(c_2*s_3 - c_3*s_2)))/5629499534213120000.0 - (552806158210613379.0*(c_4*(c_2*c_3 + s_2*s_3) + s_4*(c_2*s_3 - c_3*s_2))*((11.0*c_5)/200.0 - 11.0/200.0))/56294995342131200.0 + (276066204223679841.0*c_4*(c_2*c_3 + s_2*s_3))/562949953421312000.0 + (100247227274517223483.0*c_4*(c_2*s_3 - c_3*s_2))/11258999068426240000.0 - (1037132832287244679.0*(c_2*c_3 + s_2*s_3)*((57.0*c_4)/1000.0 - (81.0*s_4)/200.0))/56294995342131200.0 - (1037132832287244679.0*(c_2*s_3 - c_3*s_2)*((81.0*c_4)/200.0 + (57.0*s_4)/1000.0))/56294995342131200.0 - (100247227274517223483.0*s_4*(c_2*c_3 + s_2*s_3))/11258999068426240000.0 + (276066204223679841.0*s_4*(c_2*s_3 - c_3*s_2))/562949953421312000.0;
  N(4) = (16633887597705969.0*s_5*(c_4*(c_2*s_3 - c_3*s_2) - s_4*(c_2*c_3 + s_2*s_3)))/2251799813685248000.0;
}

void calcTorques(KDL::JntArray& pos, KDL::JntArray& vel, KDL::JntArray& acc, KDL::JntArray& torques)
{
  MatrixXd M(5,5);
  MatrixXd C(5,5);
  VectorXd N(5);
  getM(M,pos);
  getC(C,pos,vel);
  getN(N,pos);
  double temp;
  for(int i = 0; i<5; i++)
    {
      temp=0;
      for(int j = 0; j<5; j++)
      {
        temp+=M(i,j)*acc(j)+C(i,j)*vel(j);
      }
      torques(i)=temp+N(i);
    }
}

void pd_controller_Torques(MatrixXd & Kp, MatrixXd & Kv, KDL::JntArray& pos_err, KDL::JntArray& vel_err, KDL::JntArray& torques)
{
  VectorXd tor(5);
  VectorXd p_err(5);
  VectorXd v_err(5);
  for(int i = 0; i<5; i++)
  {
    p_err(i)=pos_err(i);
    v_err(i)=vel_err(i);
  }
  tor=-Kp*p_err-Kv*v_err;
  for(int i = 0; i<5; i++)
  {
    torques(i)+=tor(i);
  }
}

void gainMatrices(MatrixXd & Kp, MatrixXd & Kv)
{
  Kp(0,0) = 30;
  Kp(0,1) = 0;
  Kp(0,2) = 0;
  Kp(0,3) = 0;
  Kp(0,4) = 0;
  Kp(1,0) = 0;
  Kp(1,1) = 20;
  Kp(1,2) = 0;
  Kp(1,3) = 0;
  Kp(1,4) = 0;
  Kp(2,0) = 0;
  Kp(2,1) = 0;
  Kp(2,2) = 10;
  Kp(2,3) = 0;
  Kp(2,4) = 0;
  Kp(3,0) = 0;
  Kp(3,1) = 0;
  Kp(3,2) = 0;
  Kp(3,3) = 4;
  Kp(3,4) = 0;
  Kp(4,0) = 0;
  Kp(4,1) = 0;
  Kp(4,2) = 0;
  Kp(4,3) = 0;
  Kp(4,4) = 2;

  Kv=Kp;
}

#endif /* YOUBOTARMDYNAMICS_HPP_ */
